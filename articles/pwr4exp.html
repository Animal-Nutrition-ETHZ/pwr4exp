<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction • pwr4exp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pwr4exp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/pwr4exp.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/WangKai7kkw/pwr4exp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/WangKai7kkw/pwr4exp/blob/main/vignettes/pwr4exp.Rmd" class="external-link"><code>vignettes/pwr4exp.Rmd</code></a></small>
      <div class="d-none name"><code>pwr4exp.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/WangKai7kkw/pwr4exp" class="external-link">pwr4exp</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The pwr4exp R package offers functionality for power analysis and
sample size determination for some standard and common designs in animal
studies, and it can be used for various complex experimental designs.
This section provides an overview of the functionality within the
pwr4exp and explains some common arguments used in its functions. To
perform power analysis in pwr4exp involves two steps:</p>
<div class="section level3">
<h3 id="step1-creating-a-design-object">Step1: creating a design object<a class="anchor" aria-label="anchor" href="#step1-creating-a-design-object"></a>
</h3>
<p>Design objects in pwr4exp can be created using functions that
generate several standard experimental designs available in the package.
These functions include <strong>designCRD</strong> for complete
randomized design (<strong>CRD</strong>), <strong>designRCBD</strong>
for randomized complete block design (<strong>RCBD</strong>),
<strong>designLSD</strong> for Latin Square design
(<strong>LSD</strong>), <strong>designCOD</strong> for crossover design
(<strong>COD</strong>), and <strong>designSPD</strong> for split-plot
design (<strong>SPD</strong>). The arguments of these functions fall
into the following main categories:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Treatment structure:</strong> The arguments
<code>treatments</code>, <code>trt.main</code>, and <code>trt.sub</code>
are used to specify the treatment structure for designs other than SPD,
and in the case of an SPD, they refer to the main plot and subplot
levels, respectively. The treatment structure is defined by an
integer-valued vector, where the length of the vector indicates the
number of treatment factors, and each value represents the number of
levels for each factor. A maximum of two factors is allowed, and they
are arranged in a factorial design.</p>
<p>For instance, <code>treatments = 2</code> is used to define an
experiment involving only two treatments (e.g., control
vs. intervention). In the case of two factors,
<code>treatments = c(2, 2)</code> sets up a “2x2” factorial design where
two factors are arranged to study the main effects and their
interactions. In the case of SPD, <code>trt.main</code> and
<code>trt.sub</code> allow for hierarchical structuring of treatments.
For example, <code>trt.main = 2</code> specifies two levels of a main
plot treatment factor, and <code>trt.sub = c(2, 2)</code> defines a “2 ×
2” factorial design at the subplot level.</p>
</li>
<li>
<p><strong>Label:</strong> The optional argument <code>label</code>
accepts a list that specifies the names of treatment factors and their
corresponding level labels. Each element of the list represents a
factor, with the name of the element being the name of the factor. The
value of each element should be a vector containing the labels for that
factor’s levels. If not provided, the default name “trt” is assigned to
a single treatment factor, while “facA” and “facB” are used for two
treatment factors. The levels of each factor are sequentially coded as
“1”, “2”, and so on, if not specified by <code>label</code>.</p>
<p>For example, <code>list(trt = c("ad libitum", "fasting"))</code> uses
the default name for a single treatment factor, but customizes its
levels to “ad libitum” and “fasting.” For multiple factors, such as
<code>list(feed = c("``ad libitum``", "``fasting``"), dosage = c("D0", "D1", "D2"))</code>,
the first factor is named “feed” with levels “ad libitum” and “fasting”
and the second factor is named “dosage” with levels “D0,” “D1,” and
“D2.”</p>
</li>
<li>
<p><strong>Replication:</strong> Given distinct replicating
mechanisms, three arguments <code>replicates</code>,
<code>blocks</code>, and <code>squares</code> are used to represent
replication and indicate sample size for different designs. The argument
<code>replicates</code> specifies the number of experimental units per
treatment in a CRD or the number of main plots (i.e., the number of
experimental units per treatment at main plot) in a SPD;
<code>blocks</code> specifies the number of blocks in an RCBD; and
<code>squares</code> specifies the number of squares in a replicated LSD
or crossover design.</p>
<p>In CRD, <code>replicates = 10</code> along with
<code>treatments = 4</code> (or <code>treatments = c(2, 2)</code>)
indicate that each treatment group consists of 10 experimental units,
resulting in a total of 40 experimental units. While configuring a SPD,
<code>replicates = 10</code> combined with <code>trt.main = 4</code> (or
<code>trt.main = c(2, 2)</code>) signifies that each main plot treatment
is replicated across 10 experimental units, accumulating to 40 main
plots in total. In a RCBD, the argument <code>blocks = 10</code> used in
conjunction with <code>treatments = 4</code> (or
<code>treatments = c(2, 2)</code>) ensures that all four treatments are
replicated across 10 different blocks, leading to a total of 40
experimental units. For an LSD, setting <code>squares = 3</code>
alongside <code>treatments = 4</code> (or
<code>treatments = c(2, 2)</code>) implies the replication of the layout
of a single “4×4” square 3 times, resulting a total of 48 experimental
units.</p>
</li>
<li><p><strong>Model:</strong> The <code>formula</code> argument
specifies the formula that would be used to test effects in
post-experimental data analysis. This formula follows the syntax used in
R’s <code>lm</code> (procedure for linear models) and <code>lmer</code>
(procedure for LMM) functions to specify fixed and random effects. Each
design-generating function within the package comes with a default model
formula. The default model formula incorporates interaction terms when
two treatment factors are present and fits blocking factors as random
effects.</p></li>
<li>
<p><strong>Effect Size:</strong> The <code>beta</code> argument
represents model coefficients. It is noteworthy that the coefficients
for categorical variables are the coefficients of dummy variables
created using <code>contr.treatment</code> contrast coding in R. This
coding scheme designates the first level of each categorical factor as
the reference level and creates indicator variables for the other levels
to compare against this reference. The coefficient for the reference
level is the mean of that level. The coefficients for the other levels
are interpreted as the difference from this reference level.</p>
<p>For example, considering a factor with 2 levels
(<code>treatments = 2</code>), control vs. intervention (optional,
<code>label = list(trt = c("control", "intervention"))</code>), if
<code>beta = c(10, 5)</code>, this indicates that the mean of the
control group is 10, and the effect of an intervention is 5 units higher
than the control.</p>
<p>In another example with a “2 × 2” factorial arrangement of
treatments, e.g, <code>treatments = c(2, 2)</code> &amp;
<code>label= list(A = c("A1", "A2"), B = c("B1", "B2"))</code>, assume
the expected outcomes for each combination of the two factors are as
follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>B</mi><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>B</mi><mn>2</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>A</mi><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>10</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>6</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>A</mi><mn>2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>8</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>12</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{c|c|c}
  &amp; B1 &amp; B2 \\
\hline
A1 &amp; 10 &amp; 6 \\
A2 &amp; 8  &amp; 12 \\
\end{array}
</annotation></semantics></math></p>
<p>The argument for effect size reflects as
<code>beta = c(intercept = 10, A2 = -2, B2 = -4, A2B2 = 8)</code>, which
indicates that the mean of the reference level (<code>A1B1</code>), the
effect of A2 alone (<code>A2B1 - A1B1)</code>, the effect of B2 alone
(<code>A1B2 - A1B1</code>), and the interaction between A2 and B2
(<code>A2B2 - A2B1 - A1B2 + A1B1</code>), i.e., the additional effect of
combining A2B2 compared to what would be expected from the sum of
individual effects of A2 and B2. It is important to mention that values
in <code>beta</code> indicate population values (i.e., expectations),
which are usually unknown and must be derived through informed
assumptions. These values can either be directly or transformed from
group means as demonstrated.</p>
</li>
<li>
<p><strong>Variance-Covariance:</strong> The <code>VarCov</code>
specifies variance-covariance components of random effects. If there are
multiple random effects of one grouping factor, provide
variance-covariance components in a matrix that matches the order of the
random effects specified in the model formula.</p>
<p>For instance, the covariance matrix for random intercepts and random
slopes for one grouping factor is structured as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mtable><mtr><mtd columnalign="center" style="text-align: center"><msubsup><mi>τ</mi><mn>0</mn><mn>2</mn></msubsup></mtd><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>12</mn></msub></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><msub><mi>τ</mi><mn>12</mn></msub></mtd><mtd columnalign="center" style="text-align: center"><msubsup><mi>τ</mi><mn>1</mn><mn>2</mn></msubsup></mtd></mtr></mtable><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">
\begin{pmatrix}
\tau_0^2 &amp; \tau_{12} \\
\tau_{12} &amp; \tau_1^2
\end{pmatrix}
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>τ</mi><mn>0</mn><mn>2</mn></msubsup><annotation encoding="application/x-tex">\tau_0^2</annotation></semantics></math>
is the variance of the random intercept,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>τ</mi><mn>1</mn><mn>2</mn></msubsup><annotation encoding="application/x-tex">\tau_1^2</annotation></semantics></math>
is the variance of the random slope, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mn>12</mn></msub><annotation encoding="application/x-tex">\tau_{12}</annotation></semantics></math>
is the covariance between them. In the standard designs available in
pwr4exp, the corresponding LMM are typically the simplest variance
component models, i.e., models without random slopes. For example, in an
RCBD with block as a random effect, the input required is the variance
between blocks
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">VarCov</mtext><mo>=</mo><msubsup><mi>τ</mi><mi>b</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\text{VarCov} = \tau_b^2</annotation></semantics></math>.
If there are multiple grouping factors, provide the variance-covariance
matrix for each grouping factor in a list. For example, in an LSD with
both row and column blocks as random effects, the required inputs would
be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">VarCov</mtext><mo>=</mo><mi>l</mi><mi>i</mi><mi>s</mi><mi>t</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>τ</mi><mi>r</mi><mn>2</mn></msubsup><mo>,</mo><msubsup><mi>τ</mi><mi>c</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{VarCov} = list(\tau_r^2, \tau_c^2)</annotation></semantics></math>,
representing the variances of the row and column blocks,
respectively.</p>
</li>
<li><p><strong>Error Variance:</strong> <code>sigma2</code> is the
variance of random error in the model.</p></li>
</ol>
<p>A design which is not available in the package can be potentially
constructed using the function <code>designCustom</code>. The required
inputs include <code>design.df</code>, <code>design.name</code>,
<code>formula</code>, <code>beta</code>, <code>VarCov</code>, and
<code>sigma2</code>. All arguments have been defined above except for
<code>design.df</code>, which indicates a data frame with columns of
independent variables, outlining the structure of the data to be
collected from the experiment, but it does not include the response
variable. Optionally, the name of the customized design can be specified
using <code>design.name</code>.</p>
</div>
<div class="section level3">
<h3 id="step2-power-or-sample-size-calculation">Step2: power or sample size calculation<a class="anchor" aria-label="anchor" href="#step2-power-or-sample-size-calculation"></a>
</h3>
<p>Once the design object is created, calculating power or sample size
is straightforward. Power for omnibus tests, including main effects and
their interactions (if included in the model specified during the
creation of the design object), can be calculated using the
<code>pwr.anova(design = , alpha = )</code> function. The required
inputs include:</p>
<ol style="list-style-type: decimal">
<li><p><code>design</code>, which refers to the design object,</p></li>
<li><p><code>alpha</code>, indicating the Type I error rate, which has a
default value of 0.05, if not specified.</p></li>
</ol>
<p>On the other hand, power for specific contrasts can be calculated
using
<code>pwr.contrast(design = , alpha = , spec = , method = )</code>. The
same syntax of the emmeans package is inherited to specify contrasts of
interest. The required inputs are:</p>
<ol style="list-style-type: decimal">
<li><p><code>design</code> and <code>alpha</code> as defined in the
<code>pwr.anova</code> function</p></li>
<li><p><code>spec</code>, which is an argument inherited from
<code>emmeans</code> specifying the names of the factors over which the
contrasts are performed, and</p></li>
<li><p><code>method</code>, which is another argument inherited from
<code>emmeans</code> specifying the method of contrasts, e.g., pairwise,
linear, and polynomials.</p></li>
</ol>
<p>The minimal sample size needed to achieve a target power can be
determined using
<code>find_sample_size(design.quote = , alpha = , target.power = , n_init = , n_max = )</code>.
This procedure uses an iterative approach to find the minimum
replications by traversing through a series of integers. The required
inputs are:</p>
<ol style="list-style-type: decimal">
<li><p><code>design.quote</code>, which is a quoted design object with
unknown and unevaluated replications to be evaluated with varying
values,</p></li>
<li><p><code>alpha</code> as defined in the <code>pwr.anova</code>
function,</p></li>
<li><p><code>target.power</code>, which can be a single value specifying
the target power for all effects or a vector of values for individual
target power levels for each effect,</p></li>
<li><p><code>n_init</code> is the initial replications for the iterative
process, with the default value set to 2,</p></li>
<li><p><code>n_max</code> is the maximum number of replications for the
iterative process, with the default value of 99.</p></li>
</ol>
<p>This function calculates the minimum sample size necessary by
incrementally checking integers from <code>n_init</code> to
<code>n_max</code>. Currently, sample size determination is available
only for omnibus tests and not for specific contrasts in pwr4exp.</p>
</div>
</div>
<div class="section level2">
<h2 id="completely-randomized-design">Completely Randomized Design<a class="anchor" aria-label="anchor" href="#completely-randomized-design"></a>
</h2>
<div class="section level3">
<h3 id="crd-with-one-treatment-factor">CRD with one treatment factor<a class="anchor" aria-label="anchor" href="#crd-with-one-treatment-factor"></a>
</h3>
<p>The following design profile is used to create an exemplary CRD with
one treatment factor:</p>
<ol style="list-style-type: decimal">
<li><p>Treatments: 1 treatment factor with 4 levels.</p></li>
<li><p>Replicates: 8 experimental units in each of 4 groups.</p></li>
<li><p>Mean and effect size: The mean of control group is 35, and the
effects of other three treatments are -5, +2, and +3.</p></li>
<li><p>Error variance: The variance of response variable is 15.</p></li>
</ol>
<p>If not specified, the treatment factor is named “trt” and its levels
are labeled as “1”, “2”, “3”, and “4” by default. The corresponding
design is generated using the <code>designCRD</code> function:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crd1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/designCRD.html">designCRD</a></span><span class="op">(</span></span>
<span>  treatments <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  replicates <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  sigma2 <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Power of omnibus test (i.e., F-test) can be calculated using the
<code>pwr.anova</code> function. Under the type I error rate of 0.05,
the power for testing an overall difference among treatments is
0.95467.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.anova.html">pwr.anova</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">crd1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Power analysis of Completely randomized design</span></span>
<span><span class="co">#&gt;     NumDF DenDF non-centrality alpha   power</span></span>
<span><span class="co">#&gt; trt     3    28         20.267  0.05 0.95467</span></span></code></pre></div>
<p>The function <code>pwr.contrat</code> can be used to assess the power
for specific contrasts. To calculate the power for detecting the
differences of other levels to the control, contrast
<code>method = rt.vs.ctrl</code> for the treatment factor
(<code>specs = ~ trt</code>) can be defined according to the
specification of <strong>emmeans</strong> package.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">crd1</span>, specs <span class="op">=</span>  <span class="op">~</span> <span class="va">trt</span>, method <span class="op">=</span> <span class="st">"trt.vs.ctrl"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      contrast estimate df non-centrality alpha     power</span></span>
<span><span class="co">#&gt; 1 trt2 - trt1       -5 28       6.666667  0.05 0.7028739</span></span>
<span><span class="co">#&gt; 2 trt3 - trt1        2 28       1.066667  0.05 0.1694975</span></span>
<span><span class="co">#&gt; 3 trt4 - trt1        3 28       2.400000  0.05 0.3216803</span></span></code></pre></div>
<p>Another example to demonstrate specifying contrast vectors involves
the contrasts of interest: trt4 vs. trt1 (control) and comparing the
combined effect of trt1 and trt2 to that of trt3 and trt4.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">crd1</span>, </span>
<span>             specs <span class="op">=</span>  <span class="op">~</span> <span class="va">trt</span>, </span>
<span>             method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>`trt4-trt2` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                           `trt12-trt34` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span>, <span class="op">-</span><span class="fl">.5</span>, <span class="op">-</span><span class="fl">.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      contrast estimate df non-centrality alpha     power</span></span>
<span><span class="co">#&gt; 1   trt4-trt2        8 28       17.06667  0.05 0.9786069</span></span>
<span><span class="co">#&gt; 2 trt12-trt34       -5 28       13.33333  0.05 0.9410503</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="crd-with-2x2-factorial-treatments">CRD with “2x2” factorial treatments<a class="anchor" aria-label="anchor" href="#crd-with-2x2-factorial-treatments"></a>
</h3>
<p>The following design profile is used to create an exemplary CRD with
two treatment factors:</p>
<ol style="list-style-type: decimal">
<li><p>Treatments: 2 treatment factors each with 2 levels.</p></li>
<li><p>Label: two factors are “facA” with levels “A1” and “A2”, “facB”
with levels “B1” and “B2”.</p></li>
<li><p>Replicates: 8 experimental units in each of 4 groups.</p></li>
<li><p>Mean and effect size: The mean of the control (A1B1) is 35. The
effect of A2 alone is an increase of 5 units, and the effect of B2 alone
is an increase of 3 units. The interaction between A2 and B2 introduces
an additional effect of -2 units, resulting the combined effect of A2
and B2 below (-2) the sum of their individual effects. The corresponding
cell means
are:<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="center" style="text-align: center"></mtd><mtd columnalign="center" style="text-align: center"><mi>B</mi><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mi>B</mi><mn>2</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>A</mi><mn>1</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>35</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>38</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"><mi>A</mi><mn>2</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>40</mn></mtd><mtd columnalign="center" style="text-align: center"><mn>41</mn></mtd></mtr><mtr><mtd columnalign="center" style="text-align: center"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{c|c|c}
  &amp; B1 &amp; B2 \\
\hline
A1 &amp; 35 &amp; 38 \\
A2 &amp; 40  &amp; 41 \\
\end{array}
</annotation></semantics></math></p></li>
<li><p>Error variance: The variance of response variable is 15.</p></li>
</ol>
<p>This design can be created as follows:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crd2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/designCRD.html">designCRD</a></span><span class="op">(</span></span>
<span>  treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  replicates <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>facA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span><span class="op">)</span>, facB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  sigma2 <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The power of the omnibus test:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/pwr.anova.html">pwr.anova</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">crd2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Power analysis of Completely randomized design</span></span>
<span><span class="co">#&gt;           NumDF DenDF non-centrality alpha   power</span></span>
<span><span class="co">#&gt; facA          1    28         8.5333  0.05 0.80504</span></span>
<span><span class="co">#&gt; facB          1    28         2.1333  0.05 0.29178</span></span>
<span><span class="co">#&gt; facA:facB     1    28         0.5333  0.05 0.10868</span></span></code></pre></div>
<p>The power for detecting the effect of factor A, both overall and
within each level of factor B, can be assessed as follows:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># main effect of facA</span></span>
<span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">crd2</span>, specs <span class="op">=</span> <span class="op">~</span> <span class="st">"facA"</span>, method <span class="op">=</span> <span class="st">"pairwise"</span><span class="op">)</span></span>
<span><span class="co">#&gt; NOTE: Results may be misleading due to involvement in interactions</span></span>
<span><span class="co">#&gt;   contrast estimate df non-centrality alpha     power</span></span>
<span><span class="co">#&gt; 1  A1 - A2       -4 28       8.533333  0.05 0.8050374</span></span>
<span><span class="co"># effect of facA under B1 and B2, respectively</span></span>
<span><span class="fu"><a href="../reference/pwr.contrast.html">pwr.contrast</a></span><span class="op">(</span>design <span class="op">=</span> <span class="va">crd2</span>, specs <span class="op">=</span> <span class="op">~</span> <span class="va">facA</span><span class="op">|</span><span class="va">facB</span>, method <span class="op">=</span> <span class="st">"pairwise"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   contrast facB estimate df non-centrality alpha     power</span></span>
<span><span class="co">#&gt; 1  A1 - A2   B1       -5 28       6.666667  0.05 0.7028739</span></span>
<span><span class="co">#&gt; 2  A1 - A2   B2       -3 28       2.400000  0.05 0.3216803</span></span></code></pre></div>
<p>The number of units per treatment required to achieve the target
power can be determined using <code>find_sample_size</code>, which
employs an iterative approach. A quoted design object, where replicates
= n remains unevaluated, is created first.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">crd_quote</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/designCRD.html">designCRD</a></span><span class="op">(</span></span>
<span>  treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  replicates <span class="op">=</span> <span class="va">n</span>,</span>
<span>  label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>facA <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span><span class="op">)</span>, facB <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">35</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>  sigma2 <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The best sample size for the target power within the range of
<code>n_int</code> and <code>n_max</code> can be determined:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/find_sample_size.html">find_sample_size</a></span><span class="op">(</span>design.quote <span class="op">=</span> <span class="va">crd_quote</span>, n_init <span class="op">=</span> <span class="fl">2</span>, n_max <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span>
<span><span class="co">#&gt;           alpha     power best_n</span></span>
<span><span class="co">#&gt; facA       0.05 0.8050374      8</span></span>
<span><span class="co">#&gt; facB       0.05 0.8009381     30</span></span>
<span><span class="co">#&gt; facA:facB  0.05 0.7266769     99</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="randomized-complete-block-design">Randomized Complete Block Design<a class="anchor" aria-label="anchor" href="#randomized-complete-block-design"></a>
</h2>
</div>
<div class="section level2">
<h2 id="latin-square-design">Latin Square Design<a class="anchor" aria-label="anchor" href="#latin-square-design"></a>
</h2>
</div>
<div class="section level2">
<h2 id="crossover-design">Crossover Design<a class="anchor" aria-label="anchor" href="#crossover-design"></a>
</h2>
</div>
<div class="section level2">
<h2 id="split-plot-design">Split-plot Design<a class="anchor" aria-label="anchor" href="#split-plot-design"></a>
</h2>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kai Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
